<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Organizer - Complete System</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .nav-tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 5px;
            backdrop-filter: blur(10px);
        }

        .nav-tab {
            padding: 15px 25px;
            background: transparent;
            border: none;
            color: white;
            cursor: pointer;
            border-radius: 10px;
            margin: 0 5px;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .nav-tab:hover {
            background: rgba(255,255,255,0.2);
            transform: translateY(-2px);
        }

        .nav-tab.active {
            background: white;
            color: #667eea;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: transform 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .card h2 {
            margin-bottom: 20px;
            color: #667eea;
            font-size: 1.8rem;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            margin-right: 10px;
            margin-bottom: 10px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-danger {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
        }

        .btn-danger:hover {
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.4);
        }

        .goal-item {
            background: #f8f9ff;
            border: 1px solid #e1e5e9;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }

        .goal-item:hover {
            border-color: #667eea;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.1);
        }

        .goal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .goal-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #333;
        }

        .goal-status {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-active {
            background: #e8f5e8;
            color: #2d5a2d;
        }

        .status-completed {
            background: #e8f0ff;
            color: #1a365d;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e1e5e9;
            border-radius: 4px;
            margin: 10px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .file-item {
            background: #f8f9ff;
            border: 1px solid #e1e5e9;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .assignment-item {
            background: #fff5f5;
            border-left: 4px solid #ff6b6b;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 0 10px 10px 0;
        }

        .task-item {
            background: #f0fff4;
            border-left: 4px solid #48bb78;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 0 10px 10px 0;
        }

        .chart-container {
            position: relative;
            height: 400px;
            margin: 20px 0;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: #667eea;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 20px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close:hover {
            color: #000;
        }

        .hidden {
            display: none;
        }

        .form-step {
            display: none;
        }

        .form-step.active {
            display: block;
        }

        .form-step h3 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.4rem;
        }

        .step-indicator {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
        }

        .step-dot {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: #e1e5e9;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 10px;
            font-weight: bold;
            color: #666;
        }

        .step-dot.active {
            background: #667eea;
            color: white;
        }

        .step-dot.completed {
            background: #48bb78;
            color: white;
        }

        @media (max-width: 768px) {
            .nav-tabs {
                flex-wrap: wrap;
            }
            
            .nav-tab {
                margin-bottom: 5px;
            }
            
            .card {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéì Student Organizer</h1>
            <p>Your complete academic management system</p>
            <button class="btn btn-danger" onclick="clearAllData()" style="margin-top: 15px;">üóëÔ∏è Clear All Data</button>
        </div>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="switchTab('dashboard', event)">üìä Dashboard</button>
            <button class="nav-tab" onclick="switchTab('goals', event)">üéØ Study Goals</button>
            <button class="nav-tab" onclick="switchTab('progress', event)">üìà Progress</button>
            <button class="nav-tab" onclick="switchTab('organization', event)">üìã Organization</button>
            <button class="nav-tab" onclick="switchTab('files', event)">üìÅ Files</button>
            <button class="nav-tab" onclick="switchTab('reports', event)">üìÑ Reports</button>
        </div>

        <!-- Dashboard Tab -->
        <div id="dashboard" class="tab-content active">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="totalGoals">0</div>
                    <div>Total Goals</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="completedGoals">0</div>
                    <div>Completed Goals</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="totalAssignments">0</div>
                    <div>Assignments</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="totalTasks">0</div>
                    <div>Tasks</div>
                </div>
            </div>

            <div class="grid">
                <div class="card">
                    <h2>Recent Goals</h2>
                    <div id="recentGoals">No goals yet. Create your first goal!</div>
                </div>
                <div class="card">
                    <h2>Upcoming Deadlines</h2>
                    <div id="upcomingDeadlines">No upcoming deadlines.</div>
                </div>
                <div class="card">
                    <h2>Motivational Quote</h2>
                    <div id="quoteInfo">Loading inspirational quote...</div>
                </div>
            </div>
        </div>

        <!-- Study Goals Tab -->
        <div id="goals" class="tab-content">
            <div class="card">
                <h2>Create New Study Goal</h2>
                <form id="goalForm">
                    <div class="form-group">
                        <label for="goalTitle">Goal Title</label>
                        <input type="text" id="goalTitle" required>
                    </div>
                    <div class="form-group">
                        <label for="goalDescription">Description</label>
                        <textarea id="goalDescription" rows="3"></textarea>
                    </div>
                    <div class="grid">
                        <div class="form-group">
                            <label for="goalPriority">Priority</label>
                            <select id="goalPriority">
                                <option value="low">Low</option>
                                <option value="medium" selected>Medium</option>
                                <option value="high">High</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="goalDeadline">Deadline</label>
                            <input type="date" id="goalDeadline">
                        </div>
                    </div>
                    <button type="submit" class="btn">Create Goal</button>
                </form>
            </div>

            <div class="card">
                <h2>Your Study Goals</h2>
                <div id="goalsList">No goals created yet.</div>
                <div style="text-align: center; margin-top: 20px;">
                    <button class="btn" onclick="switchTab('progress', event)">üìà View Progress Chart</button>
                </div>
            </div>
        </div>

        <!-- Progress Tab -->
        <div id="progress" class="tab-content">
            <div class="card">
                <h2>Study Progress Chart</h2>
                <div class="chart-container">
                    <canvas id="progressChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Organization Hub Tab -->
        <div id="organization" class="tab-content">
            <div class="card">
                <h2>Assignment & Task Manager</h2>
                <!-- Step 1: Assignment Form -->
                <div id="step1" class="form-step active">
                    <h3>Step 1: Add Assignment</h3>
                    <form id="assignmentForm">
                        <div class="form-group">
                            <label for="assignmentTitle">Assignment Title</label>
                            <input type="text" id="assignmentTitle" required>
                        </div>
                        <div class="form-group">
                            <label for="assignmentDue">Due Date</label>
                            <input type="date" id="assignmentDue" required>
                        </div>
                        <div class="form-group">
                            <label for="assignmentDescription">Description (Optional)</label>
                            <textarea id="assignmentDescription" rows="3" placeholder="Add any additional details about the assignment..."></textarea>
                        </div>
                        <button type="submit" class="btn">Next: Add Tasks</button>
                    </form>
                </div>
                <!-- Step 2: Task Form -->
                <div id="step2" class="form-step">
                    <h3>Step 2: Add Tasks for "<span id="assignmentTitleDisplay"></span>"</h3>
                    <form id="taskForm">
                        <div class="form-group">
                            <label for="taskTitle">Task Title</label>
                            <input type="text" id="taskTitle" required>
                        </div>
                        <div class="form-group">
                            <label for="taskPriority">Priority</label>
                            <select id="taskPriority">
                                <option value="low">Low</option>
                                <option value="medium" selected>Medium</option>
                                <option value="high">High</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="taskDescription">Description (Optional)</label>
                            <textarea id="taskDescription" rows="3" placeholder="Add any additional details about the task..."></textarea>
                        </div>
                        <div class="form-group">
                            <label for="taskDueDate">Task Due Date</label>
                            <input type="date" id="taskDueDate">
                        </div>
                        <div style="display: flex; gap: 10px; margin-top: 20px;">
                            <button type="button" class="btn" onclick="goBackToStep1()">‚Üê Back to Assignment</button>
                            <button type="submit" class="btn">Add Task & Continue</button>
                            <button type="button" class="btn" onclick="finishProcess()">Finish Process</button>
                        </div>
                    </form>
                </div>
                <!-- Step 3: Success Message -->
                <div id="step3" class="form-step">
                    <div style="text-align: center; padding: 40px;">
                        <h3 style="color: #667eea; margin-bottom: 20px;">‚úÖ Assignment & Tasks Created Successfully!</h3>
                        <p style="margin-bottom: 30px;">Your assignment and associated tasks have been added to your organizer.</p>
                        <div style="margin-bottom: 30px;">
                            <h4>Assignment Summary:</h4>
                            <div id="assignmentSummary" style="background: #f8f9ff; padding: 15px; border-radius: 10px; margin: 10px 0;"></div>
                        </div>
                        <div style="margin-bottom: 30px;">
                            <h4>Tasks Created:</h4>
                            <div id="tasksSummary" style="background: #f0fff4; padding: 15px; border-radius: 10px; margin: 10px 0;"></div>
                        </div>
                        <button class="btn" onclick="resetForm()">Add Another Assignment</button>
                    </div>
                </div>
                <!-- Current Assignments Display -->
                <div style="margin-top: 40px;">
                    <h3>Current Assignments</h3>
                    <div id="assignmentsList">No assignments yet.</div>
                </div>
            </div>
        </div>

        <!-- File Manager Tab -->
        <div id="files" class="tab-content">
            <div class="card">
                <h2>File Manager</h2>
                <form id="fileForm">
                    <div class="form-group">
                        <label for="fileName">File Name</label>
                        <input type="text" id="fileName" required>
                    </div>
                    <div class="form-group">
                        <label for="fileCategory">Category</label>
                        <select id="fileCategory">
                            <option value="notes">Notes</option>
                            <option value="assignments">Assignments</option>
                            <option value="resources">Resources</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <button type="submit" class="btn">Add File Reference</button>
                </form>
                <div id="filesList">No files added yet.</div>
            </div>
        </div>

        <!-- Reports Tab -->
        <div id="reports" class="tab-content">
            <div class="card">
                <h2>Detailed Progress Report</h2>
                <button class="btn" onclick="generateReport()">Generate Report</button>
                <div id="reportContent">
                    <p>Click "Generate Report" to see your detailed progress analysis.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Goal Details Modal -->
    <div id="goalModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h2>Goal Details</h2>
            <div id="goalModalContent"></div>
        </div>
    </div>

    <script>
        // Data storage
        let studyGoals = [];
        let assignments = [];
        let tasks = [];
        let files = [];
        let progressChart = null;

        // Multi-step form variables
        let currentAssignment = null;
        let currentTasks = [];
        let currentStep = 1;

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            updateDashboard();
            initializeChart();

            // Set up form event listeners
            document.getElementById('goalForm').addEventListener('submit', createGoal);
            document.getElementById('assignmentForm').addEventListener('submit', handleAssignmentSubmit);
            document.getElementById('taskForm').addEventListener('submit', handleTaskSubmit);
            document.getElementById('fileForm').addEventListener('submit', addFile);

            // Fetch motivational quote
            fetchMotivationalQuote();
        });

        // Tab switching
        function switchTab(tabName, event) {
            // Hide all tab contents
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(tab => tab.classList.remove('active'));

            // Remove active class from all nav tabs
            const navTabs = document.querySelectorAll('.nav-tab');
            navTabs.forEach(tab => tab.classList.remove('active'));

            // Show selected tab and mark nav tab as active
            document.getElementById(tabName).classList.add('active');
            if (event && event.target) event.target.classList.add('active');

            // Update chart if switching to progress tab
            if (tabName === 'progress') {
                updateChart();
            }
        }

        // Motivational Quote API (Free public API)
        function fetchMotivationalQuote() {
            // Using a free public API that doesn't require authentication
            // Add timestamp to force new quote and bypass caching
            const timestamp = new Date().getTime();
            fetch(`https://api.quotable.io/random?tags=motivational|success|inspirational&_t=${timestamp}`)
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(data => {
                if (data && data.content) {
                    document.getElementById('quoteInfo').innerHTML = `
                        <blockquote style="font-size:1.2rem; color:#667eea; margin-bottom:10px;">"${data.content}"</blockquote>
                        <div style="text-align:right; color:#764ba2;">- ${data.author || 'Unknown'}</div>
                    `;
                } else {
                    throw new Error('No quote data received');
                }
            })
            .catch(error => {
                console.error('Error fetching quote:', error);
                // Fallback to a static motivational quote
                document.getElementById('quoteInfo').innerHTML = `
                    <blockquote style="font-size:1.2rem; color:#667eea; margin-bottom:10px;">"The only way to do great work is to love what you do."</blockquote>
                    <div style="text-align:right; color:#764ba2;">- Steve Jobs</div>
                    <div style="text-align:center; margin-top:10px; font-size:0.9rem; color:#666;">(Quote API temporarily unavailable)</div>
                `;
            });
        }

        // Function to refresh motivational quote (for clear all data)
        function refreshMotivationalQuote() {
            // First show loading state
            document.getElementById('quoteInfo').innerHTML = 'Loading new inspirational quote...';
            
            // Use different tags and random parameters to ensure new quote
            const tags = ['motivational', 'success', 'inspirational', 'leadership', 'wisdom'];
            const randomTag = tags[Math.floor(Math.random() * tags.length)];
            const timestamp = new Date().getTime();
            const randomParam = Math.random();
            
            fetch(`https://api.quotable.io/random?tags=${randomTag}&_t=${timestamp}&_r=${randomParam}`)
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(data => {
                if (data && data.content) {
                    document.getElementById('quoteInfo').innerHTML = `
                        <blockquote style="font-size:1.2rem; color:#667eea; margin-bottom:10px;">"${data.content}"</blockquote>
                        <div style="text-align:right; color:#764ba2;">- ${data.author || 'Unknown'}</div>
                    `;
                } else {
                    throw new Error('No quote data received');
                }
            })
            .catch(error => {
                console.error('Error fetching new quote:', error);
                // Fallback to a different static motivational quote
                const fallbackQuotes = [
                    { quote: "The future belongs to those who believe in the beauty of their dreams.", author: "Eleanor Roosevelt" },
                    { quote: "Success is not final, failure is not fatal: it is the courage to continue that counts.", author: "Winston Churchill" },
                    { quote: "The only limit to our realization of tomorrow is our doubts of today.", author: "Franklin D. Roosevelt" },
                    { quote: "Believe you can and you're halfway there.", author: "Theodore Roosevelt" },
                    { quote: "It always seems impossible until it's done.", author: "Nelson Mandela" }
                ];
                const randomQuote = fallbackQuotes[Math.floor(Math.random() * fallbackQuotes.length)];
                document.getElementById('quoteInfo').innerHTML = `
                    <blockquote style="font-size:1.2rem; color:#667eea; margin-bottom:10px;">"${randomQuote.quote}"</blockquote>
                    <div style="text-align:right; color:#764ba2;">- ${randomQuote.author}</div>
                    <div style="text-align:center; margin-top:10px; font-size:0.9rem; color:#666;">(Fresh start quote)</div>
                `;
            });
        }

        // Study Goals functionality
        function createGoal(e) {
            e.preventDefault();
            const goal = {
                id: Date.now(),
                title: document.getElementById('goalTitle').value,
                description: document.getElementById('goalDescription').value,
                priority: document.getElementById('goalPriority').value,
                deadline: document.getElementById('goalDeadline').value,
                status: 'active',
                progress: 0,
                createdAt: new Date().toISOString()
            };
            studyGoals.push(goal);
            saveData();
            displayGoals();
            updateDashboard();
            document.getElementById('goalForm').reset();
            alert('Goal created successfully!');
        }

        function displayGoals() {
            const goalsList = document.getElementById('goalsList');
            if (studyGoals.length === 0) {
                goalsList.innerHTML = '<p>No goals created yet.</p>';
                return;
            }
            goalsList.innerHTML = studyGoals.map(goal => `
                <div class="goal-item">
                    <div class="goal-header">
                        <div class="goal-title">${goal.title}</div>
                        <div class="goal-status status-${goal.status}">${goal.status}</div>
                    </div>
                    <p>${goal.description}</p>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${goal.progress}%"></div>
                    </div>
                    <p>Progress: ${goal.progress}%</p>
                    ${goal.deadline ? `<p><strong>Deadline:</strong> ${new Date(goal.deadline).toLocaleDateString()}</p>` : ''}
                    <div style="margin-top: 10px;">
                        <button class="btn" onclick="updateProgress(${goal.id})">Update Progress</button>
                        <button class="btn" onclick="toggleGoalStatus(${goal.id})">${goal.status === 'active' ? 'Mark Complete' : 'Mark Active'}</button>
                        <button class="btn btn-danger" onclick="deleteGoal(${goal.id})">Delete</button>
                    </div>
                </div>
            `).join('');
        }

        function updateProgress(goalId) {
            const newProgress = prompt('Enter progress percentage (0-100):');
            if (newProgress !== null && !isNaN(newProgress) && newProgress >= 0 && newProgress <= 100) {
                const goal = studyGoals.find(g => g.id === goalId);
                if (goal) {
                    goal.progress = parseInt(newProgress);
                    if (goal.progress === 100) {
                        goal.status = 'completed';
                    }
                    saveData();
                    displayGoals();
                    updateDashboard();
                    updateChart();
                }
            }
        }

        function toggleGoalStatus(goalId) {
            const goal = studyGoals.find(g => g.id === goalId);
            if (goal) {
                goal.status = goal.status === 'active' ? 'completed' : 'active';
                if (goal.status === 'completed') {
                    goal.progress = 100;
                }
                saveData();
                displayGoals();
                updateDashboard();
                updateChart();
            }
        }

        function deleteGoal(goalId) {
            if (confirm('Are you sure you want to delete this goal?')) {
                studyGoals = studyGoals.filter(g => g.id !== goalId);
                saveData();
                displayGoals();
                updateDashboard();
                updateChart();
            }
        }

        // Multi-step form functionality
        function handleAssignmentSubmit(e) {
            e.preventDefault();
            currentAssignment = {
                id: Date.now(),
                title: document.getElementById('assignmentTitle').value,
                dueDate: document.getElementById('assignmentDue').value,
                description: document.getElementById('assignmentDescription').value,
                completed: false,
                createdAt: new Date().toISOString()
            };
            currentTasks = [];
            document.getElementById('assignmentTitleDisplay').textContent = currentAssignment.title;
            goToStep(2);
        }

        function handleTaskSubmit(e) {
            e.preventDefault();
            const task = {
                id: Date.now(),
                title: document.getElementById('taskTitle').value,
                priority: document.getElementById('taskPriority').value,
                description: document.getElementById('taskDescription').value,
                dueDate: document.getElementById('taskDueDate').value,
                assignmentId: currentAssignment.id,
                completed: false,
                createdAt: new Date().toISOString()
            };
            currentTasks.push(task);
            document.getElementById('taskForm').reset();
            document.getElementById('taskPriority').value = 'medium';
            alert(`Task "${task.title}" added successfully!`);
        }

        function goToStep(step) {
            document.querySelectorAll('.form-step').forEach(s => s.classList.remove('active'));
            document.getElementById(`step${step}`).classList.add('active');
            currentStep = step;
        }

        function goBackToStep1() {
            goToStep(1);
        }

        function finishProcess() {
            assignments.push(currentAssignment);
            tasks.push(...currentTasks);
            saveData();
            displayAssignments();
            updateDashboard();
            showSuccessSummary();
            goToStep(3);
        }

        function showSuccessSummary() {
            const assignmentSummary = document.getElementById('assignmentSummary');
            assignmentSummary.innerHTML = `
                <strong>${currentAssignment.title}</strong><br>
                <small>Due: ${new Date(currentAssignment.dueDate).toLocaleDateString()}</small>
                ${currentAssignment.description ? `<br><small>${currentAssignment.description}</small>` : ''}
            `;
            const tasksSummary = document.getElementById('tasksSummary');
            if (currentTasks.length === 0) {
                tasksSummary.innerHTML = '<em>No tasks were added</em>';
            } else {
                tasksSummary.innerHTML = currentTasks.map(task => `
                    <div style="margin-bottom: 8px;">
                        <strong>${task.title}</strong> (${task.priority} priority)
                        ${task.dueDate ? `<br><small>Due: ${new Date(task.dueDate).toLocaleDateString()}</small>` : ''}
                    </div>
                `).join('');
            }
        }

        function resetForm() {
            document.getElementById('assignmentForm').reset();
            document.getElementById('taskForm').reset();
            document.getElementById('taskPriority').value = 'medium';
            currentAssignment = null;
            currentTasks = [];
            currentStep = 1;
            goToStep(1);
        }

        function displayAssignments() {
            const assignmentsList = document.getElementById('assignmentsList');
            if (assignments.length === 0) {
                assignmentsList.innerHTML = '<p>No assignments yet.</p>';
                return;
            }
            assignmentsList.innerHTML = assignments.map(assignment => {
                const assignmentTasks = tasks.filter(t => t.assignmentId === assignment.id);
                return `
                    <div class="assignment-item">
                        <h4>${assignment.title}</h4>
                        <p><strong>Due:</strong> ${new Date(assignment.dueDate).toLocaleDateString()}</p>
                        ${assignment.description ? `<p><strong>Description:</strong> ${assignment.description}</p>` : ''}
                        <p><strong>Status:</strong> ${assignment.completed ? 'Completed' : 'Pending'}</p>
                        ${assignmentTasks.length > 0 ? `
                            <div style="margin: 15px 0; padding: 10px; background: #f8f9ff; border-radius: 8px;">
                                <h5 style="margin-bottom: 10px;">Associated Tasks (${assignmentTasks.length})</h5>
                                ${assignmentTasks.map(task => `
                                    <div style="margin: 8px 0; padding: 8px; background: white; border-radius: 6px; border-left: 3px solid #48bb78;">
                                        <strong>${task.title}</strong> (${task.priority} priority)
                                        ${task.dueDate ? `<br><small>Due: ${new Date(task.dueDate).toLocaleDateString()}</small>` : ''}
                                        <br><small>Status: ${task.completed ? 'Completed' : 'Pending'}</small>
                                        <div style="margin-top: 5px;">
                                            <button class="btn" style="padding: 5px 10px; font-size: 12px;" onclick="toggleTask(${task.id})">${task.completed ? 'Mark Pending' : 'Mark Complete'}</button>
                                            <button class="btn btn-danger" style="padding: 5px 10px; font-size: 12px;" onclick="deleteTask(${task.id})">Delete</button>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        ` : '<p><em>No tasks associated with this assignment</em></p>'}
                        <button class="btn" onclick="toggleAssignment(${assignment.id})">${assignment.completed ? 'Mark Pending' : 'Mark Complete'}</button>
                        <button class="btn btn-danger" onclick="deleteAssignment(${assignment.id})">Delete</button>
                    </div>
                `;
            }).join('');
        }

        function toggleAssignment(assignmentId) {
            const assignment = assignments.find(a => a.id === assignmentId);
            if (assignment) {
                assignment.completed = !assignment.completed;
                saveData();
                displayAssignments();
                updateDashboard();
            }
        }

        function deleteAssignment(assignmentId) {
            if (confirm('Are you sure you want to delete this assignment? This will also delete all associated tasks.')) {
                assignments = assignments.filter(a => a.id !== assignmentId);
                tasks = tasks.filter(t => t.assignmentId !== assignmentId);
                saveData();
                displayAssignments();
                updateDashboard();
            }
        }

        function toggleTask(taskId) {
            const task = tasks.find(t => t.id === taskId);
            if (task) {
                task.completed = !task.completed;
                saveData();
                displayAssignments();
                updateDashboard();
            }
        }

        function deleteTask(taskId) {
            if (confirm('Are you sure you want to delete this task?')) {
                tasks = tasks.filter(t => t.id !== taskId);
                saveData();
                displayAssignments();
                updateDashboard();
            }
        }

        // File Manager functionality
        function addFile(e) {
            e.preventDefault();
            const file = {
                id: Date.now(),
                name: document.getElementById('fileName').value,
                category: document.getElementById('fileCategory').value,
                addedAt: new Date().toISOString()
            };
            files.push(file);
            saveData();
            displayFiles();
            document.getElementById('fileForm').reset();
            alert('File reference added successfully!');
        }

        function displayFiles() {
            const filesList = document.getElementById('filesList');
            if (files.length === 0) {
                filesList.innerHTML = '<p>No files added yet.</p>';
                return;
            }
            filesList.innerHTML = files.map(file => `
                <div class="file-item">
                    <div>
                        <strong>${file.name}</strong><br>
                        <small>Category: ${file.category} | Added: ${new Date(file.addedAt).toLocaleDateString()}</small>
                    </div>
                    <button class="btn btn-danger" onclick="deleteFile(${file.id})">Delete</button>
                </div>
            `).join('');
        }

        function deleteFile(fileId) {
            if (confirm('Are you sure you want to delete this file reference?')) {
                files = files.filter(f => f.id !== fileId);
                saveData();
                displayFiles();
            }
        }

        // Chart functionality
        function initializeChart() {
            const ctx = document.getElementById('progressChart').getContext('2d');
            progressChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Completed Goals', 'Active Goals'],
                    datasets: [{
                        data: [0, 0],
                        backgroundColor: [
                            'rgba(102, 126, 234, 0.8)',
                            'rgba(118, 75, 162, 0.8)'
                        ],
                        borderColor: [
                            'rgba(102, 126, 234, 1)',
                            'rgba(118, 75, 162, 1)'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom' },
                        title: { display: true, text: 'Goals Progress Overview' }
                    }
                }
            });
        }

        function updateChart() {
            if (progressChart) {
                const completedGoals = studyGoals.filter(g => g.status === 'completed').length;
                const activeGoals = studyGoals.filter(g => g.status === 'active').length;
                progressChart.data.datasets[0].data = [completedGoals, activeGoals];
                progressChart.update();
            }
        }

        // Dashboard functionality
        function updateDashboard() {
            document.getElementById('totalGoals').textContent = studyGoals.length;
            document.getElementById('completedGoals').textContent = studyGoals.filter(g => g.status === 'completed').length;
            document.getElementById('totalAssignments').textContent = assignments.length;
            document.getElementById('totalTasks').textContent = tasks.length;
            const recentGoals = document.getElementById('recentGoals');
            if (studyGoals.length === 0) {
                recentGoals.innerHTML = 'No goals yet. Create your first goal!';
            } else {
                const recent = studyGoals.slice(-3).reverse();
                recentGoals.innerHTML = recent.map(goal => `
                    <div style="margin-bottom: 10px; padding: 10px; background: #f8f9ff; border-radius: 8px;">
                        <strong>${goal.title}</strong><br>
                        <small>Progress: ${goal.progress}% | Status: ${goal.status}</small>
                    </div>
                `).join('');
            }
            const upcomingDeadlines = document.getElementById('upcomingDeadlines');
            const deadlines = [
                ...studyGoals.filter(g => g.deadline && g.status === 'active').map(g => ({...g, type: 'goal'})),
                ...assignments.filter(a => !a.completed).map(a => ({...a, deadline: a.dueDate, type: 'assignment'}))
            ].sort((a, b) => new Date(a.deadline) - new Date(b.deadline));
            if (deadlines.length === 0) {
                upcomingDeadlines.innerHTML = 'No upcoming deadlines.';
            } else {
                upcomingDeadlines.innerHTML = deadlines.slice(0, 5).map(item => `
                    <div style="margin-bottom: 10px; padding: 10px; background: #fff5f5; border-radius: 8px;">
                        <strong>${item.title}</strong><br>
                        <small>${item.type === 'goal' ? 'Goal' : 'Assignment'} | Due: ${new Date(item.deadline).toLocaleDateString()}</small>
                    </div>
                `).join('');
            }
        }

        // Reports functionality
        function generateReport() {
            const reportContent = document.getElementById('reportContent');
            const totalGoals = studyGoals.length;
            const completedGoals = studyGoals.filter(g => g.status === 'completed').length;
            const activeGoals = studyGoals.filter(g => g.status === 'active').length;
            const completionRate = totalGoals > 0 ? ((completedGoals / totalGoals) * 100).toFixed(1) : 0;
            const completedAssignments = assignments.filter(a => a.completed).length;
            const pendingAssignments = assignments.filter(a => !a.completed).length;
            const completedTasks = tasks.filter(t => t.completed).length;
            const pendingTasks = tasks.filter(t => !t.completed).length;
            const avgProgress = totalGoals > 0 ? (studyGoals.reduce((sum, goal) => sum + goal.progress, 0) / totalGoals).toFixed(1) : 0;
            reportContent.innerHTML = `
                <div style="background: #f8f9ff; padding: 20px; border-radius: 12px; margin-top: 20px;">
                    <h3>üìä Academic Progress Report</h3>
                    <p><strong>Generated on:</strong> ${new Date().toLocaleDateString()}</p>
                    <h4>üéØ Study Goals Summary</h4>
                    <ul>
                        <li>Total Goals: ${totalGoals}</li>
                        <li>Completed Goals: ${completedGoals}</li>
                        <li>Active Goals: ${activeGoals}</li>
                        <li>Completion Rate: ${completionRate}%</li>
                        <li>Average Progress: ${avgProgress}%</li>
                    </ul>
                    <h4>üìã Assignments Summary</h4>
                    <ul>
                        <li>Total Assignments: ${assignments.length}</li>
                        <li>Completed: ${completedAssignments}</li>
                        <li>Pending: ${pendingAssignments}</li>
                    </ul>
                    <h4>‚úÖ Tasks Summary</h4>
                    <ul>
                        <li>Total Tasks: ${tasks.length}</li>
                        <li>Completed: ${completedTasks}</li>
                        <li>Pending: ${pendingTasks}</li>
                    </ul>
                    <h4>üìÅ File Management</h4>
                    <ul>
                        <li>Total Files Tracked: ${files.length}</li>
                        <li>Notes: ${files.filter(f => f.category === 'notes').length}</li>
                        <li>Assignments: ${files.filter(f => f.category === 'assignments').length}</li>
                        <li>Resources: ${files.filter(f => f.category === 'resources').length}</li>
                        <li>Other: ${files.filter(f => f.category === 'other').length}</li>
                    </ul>
                    <h4>üí° Recommendations</h4>
                    <ul>
                        ${completionRate < 50 ? '<li>Consider breaking down large goals into smaller, manageable tasks</li>' : ''}
                        ${pendingAssignments > 5 ? '<li>Focus on completing pending assignments to avoid deadline stress</li>' : ''}
                        ${activeGoals === 0 ? '<li>Set new study goals to maintain academic momentum</li>' : ''}
                        ${avgProgress < 30 ? '<li>Review your study strategies and consider seeking additional support</li>' : ''}
                        ${completionRate > 80 ? '<li>Excellent progress! Consider setting more challenging goals</li>' : ''}
                    </ul>
                </div>
            `;
        }

        // Data persistence
        function saveData() {
            const data = {
                studyGoals: studyGoals,
                assignments: assignments,
                tasks: tasks,
                files: files
            };
            window.studentOrganizerData = data;
        }

        function loadData() {
            if (window.studentOrganizerData) {
                const data = window.studentOrganizerData;
                studyGoals = data.studyGoals || [];
                assignments = data.assignments || [];
                tasks = data.tasks || [];
                files = data.files || [];
            }
            displayGoals();
            displayAssignments();
            displayFiles();
        }

        // Clear all data function
        function clearAllData() {
            const confirmed = confirm('‚ö†Ô∏è WARNING: This will permanently delete ALL your data including:\n\n‚Ä¢ All study goals\n‚Ä¢ All assignments and tasks\n‚Ä¢ All file references\n‚Ä¢ All progress data\n\nThis action cannot be undone!\n\nAre you sure you want to clear everything?');
            
            if (confirmed) {
                // Clear all data arrays
                studyGoals = [];
                assignments = [];
                tasks = [];
                files = [];
                
                // Reset chart
                if (progressChart) {
                    progressChart.destroy();
                    progressChart = null;
                }
                
                // Save empty data
                saveData();
                
                // Update all displays
                displayGoals();
                displayAssignments();
                displayFiles();
                updateDashboard();
                
                // Reinitialize chart
                initializeChart();
                
                // Switch back to dashboard tab first
                switchTab('dashboard');
                
                // Fetch a new motivational quote after a short delay to ensure UI is ready
                setTimeout(() => {
                    refreshMotivationalQuote();
                }, 100);
                
                // Show success message
                alert('‚úÖ All data has been cleared successfully! You are now on the Dashboard with a fresh start.');
            }
        }

        // Modal functionality
        function closeModal() {
            document.getElementById('goalModal').style.display = 'none';
        }
        window.onclick = function(event) {
            const modal = document.getElementById('goalModal');
            if (event.target === modal) {
                modal.style.display = 'none';
            }}
        